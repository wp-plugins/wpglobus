var WPGlobusCustomize;jQuery(document).ready(function(a){"use strict";if("undefined"!=typeof WPGlobusCoreData.customize){var b={languages:{},index:0,length:0,positionSet:!1,selectorHtml:'<span style="margin-left:5px;" class="wpglobus-icon-globe"></span><span style="font-weight:bold;">{{language}}</span>',init:function(c){a.each(WPGlobusCoreData.enabled_languages,function(a,c){b.languages[a]=c,b.length=a}),b.addLanguageSelector(),b.setElements(),b.addListeners()},setTitle:function(){a(WPGlobusCoreData.customize.info.element).html(WPGlobusCoreData.customize.info.html)},getString:function(b){var c=WPGlobusCore.getTranslations(b),d=[],e=0;return a.each(c,function(a,b){d[e]=""==b?"null":b,e++}),d=d.join(":::")},setElements:function(){b.setTitle();var c;a.each(WPGlobusCoreData.customize.addElements,function(d,e){var f=a(e.element);f.attr("id",d).val(e.value).trigger("change"),"textarea"==e.type&&"undefined"!=typeof e.textarea_attrs&&f.addClass(e.textarea_attrs["class"]),"undefined"!=typeof e.options&&("undefined"!=typeof e.options.setValue&&e.options.setValue&&(c=a(e.origin_element).val(),f.data("source",c),f.val(WPGlobusCore.TextFilter(c,WPGlobusCoreData.language,"RETURN_EMPTY")),f.hasClass("wpglobus-control-url")&&a(e.origin_element).val(b.getString(c))),"undefined"!=typeof e.options.setLabel&&e.options.setLabel&&(a(e.title).text(a(e.origin_title).text()),a(e.description).text(a(e.origin_description).text()))),f.on("change",function(c){var d=a(this),e=a(WPGlobusCoreData.customize.addElements[a(this).data("customize-setting-link")].origin_element);d.data("source",WPGlobusCore.getString(d.data("source"),d.val())),d.hasClass("wpglobus-control-url")?e.val(b.getString(d.data("source"))):e.val(WPGlobusCore.getString(e.val(),d.val())),d.hasClass("wpglobus-not-trigger-change")||e.trigger("change")})})},addLanguageSelector:function(){a('<a style="margin-left:48px;" class="customize-controls-close wpglobus-customize-selector"><span class="wpglobus-globe"></span></a>').insertAfter(".customize-controls-preview-toggle"),a(".wpglobus-customize-selector").html(b.selectorHtml.replace("{{language}}",WPGlobusCoreData.language))},setPosition:function(b){if("undefined"!=typeof b.options.setPosition&&b.options.setPosition){var c=a(b.parent).detach();c.insertBefore(b.origin_parent),a(b.parent).css({display:"block"})}},addListeners:function(){a(document).on("click",".control-section",function(c){b.positionSet||(b.positionSet=!0,a.each(WPGlobusCoreData.customize.addElements,function(c,d){a(d.origin_parent).css({display:"none"}),a(d.origin_parent+" label").css({display:"none"}),"undefined"!=typeof d.options&&b.setPosition(d)}))}),a(document).on("click",".wpglobus-customize-selector",function(c){b.index>b.length-1?b.index=0:b.index++,WPGlobusCoreData.language=b.languages[b.index],a(this).html(b.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),a(".wpglobus-customize-control").each(function(b,c){if("undefined"!=typeof WPGlobusCoreData.customize.addElements[a(c).data("customize-setting-link")]){var d=a(WPGlobusCoreData.customize.addElements[a(c).data("customize-setting-link")].origin_element),e=a(c);e.hasClass("wpglobus-control-url")?e.val(WPGlobusCore.TextFilter(e.data("source"),WPGlobusCoreData.language,"RETURN_EMPTY")):e.val(WPGlobusCore.TextFilter(d.val(),WPGlobusCoreData.language,"RETURN_EMPTY"))}})}),a(document).ajaxSend(function(b,c,d){if("undefined"!=typeof d.data&&d.data.indexOf("action=customize_save")>=0){var e,f,g=d.data.split("&");a.each(g,function(a,b){return e=b.split("="),"customized"==e[0]?void(f=e[1]):void 0});var h=decodeURIComponent(f);h=JSON.parse(h),a.each(WPGlobusCoreData.customize.addElements,function(b,c){"undefined"!=typeof h[b]&&(h[c.origin]=a(WPGlobusCoreData.customize.addElements[b].origin_element).val())}),d.data=d.data.replace(f,JSON.stringify(h))}})}};WPGlobusCustomize=a.extend({},WPGlobusCustomize,b),WPGlobusCustomize.init()}});