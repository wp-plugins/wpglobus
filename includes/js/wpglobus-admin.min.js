jQuery(document).ready(function(){"use strict";window.WPGlobusAdminApp=function(a,b){return a.App=function(a){void 0===window.WPGlobusAdminApp&&(this.config={debug:!1,version:WPGlobusAdmin.version},this.status="ok","undefined"===WPGlobusAdmin?(this.status="error",this.config.debug&&console.log("Error options loading")):this.config.debug&&console.dir(WPGlobusAdmin),this.config.disable_first_language=['<div id="disable_first_language" style="display:block;" class="redux-field-errors notice-red">',"<strong>","<span>&nbsp;</span>",WPGlobusAdmin.i18n.cannot_disable_language,"</strong>","</div>"].join(""),b.extend(this.config,a),"ok"===this.status&&this.init())},a.App.prototype={init:function(){b("#content").addClass("wpglobus-editor").attr("data-language",WPGlobusAdmin.data.default_language),b("textarea[id^=content_]").each(function(a,c){var d=b(c).attr("id").replace("content_","");b(c).attr("data-language",d)}),"post-edit"===WPGlobusAdmin.page?this.post_edit():"menu-edit"===WPGlobusAdmin.page?this.nav_menus():"taxonomy-edit"===WPGlobusAdmin.page?WPGlobusAdmin.data.tag_id&&this.taxonomy_edit():"taxonomy-quick-edit"===WPGlobusAdmin.page?this.quick_edit("taxonomy"):"edit.php"===WPGlobusAdmin.page?this.quick_edit("post"):"options-general.php"==WPGlobusAdmin.page?this.options_general():this.start()},options_general:function(){var a=b("#blogname");a.addClass("hidden"),b("#wpglobus-blogname").insertAfter(a),b("body").on("blur",".wpglobus-blogname",function(){var c="";b(".wpglobus-blogname").each(function(a,d){var e=b(d),f=e.data("language");""!==e.val()&&(c=c+WPGlobusAdmin.data.locale_tag_start.replace("%s",f)+e.val()+WPGlobusAdmin.data.locale_tag_end)}),a.val(c)});var c=b("#blogdescription");c.addClass("hidden"),b("#wpglobus-blogdescription").insertAfter(c),b("body").on("blur",".wpglobus-blogdesc",function(){var a="";b(".wpglobus-blogdesc").each(function(c,d){var e=b(d),f=e.data("language");""!==e.val()&&(a=a+WPGlobusAdmin.data.locale_tag_start.replace("%s",f)+e.val()+WPGlobusAdmin.data.locale_tag_end)}),c.val(a)})},quick_edit:function(a){if("undefined"!=typeof WPGlobusAdmin.data.has_items&&WPGlobusAdmin.data.has_items){var c=0,d=0;b(document).ajaxComplete(function(a,e,f){"undefined"!=typeof f.data&&0!=c&&f.data.indexOf("action=inline-save-tax&")>=0&&(b("#"+c+" a.row-title").text(WPGlobusAdmin.qedit_titles[d][WPGlobusAdmin.data.language].name),b("#"+c+" .description").text(WPGlobusAdmin.qedit_titles[d][WPGlobusAdmin.data.language].description))});var e={};b("#the-list tr").each(function(c,f){var g=b(f),h="post"===a?"post-":"tag-";d=g.attr("id").replace(h,""),e[d]={},"post"===a?e[d].source=g.find(".post_title").text():"taxonomy"===a&&(e[d].source=b("#inline_"+d+" .name").text())});var f={};f.action="get_titles",f.type=a,f.taxonomy="undefined"==typeof WPGlobusAdmin.data.taxonomy?!1:WPGlobusAdmin.data.taxonomy,f.title=e,b.ajax({type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusAdmin.process_ajax,order:f},dataType:"json"}).done(function(a){WPGlobusAdmin.qedit_titles=a.qedit_titles,b.each(a.bulkedit_post_titles,function(a,c){b("#inline_"+a+" .post_title").text(c[WPGlobusAdmin.data.language].name)})}).fail(function(){}).always(function(){}),b("body").on("change",".wpglobus-quick-edit-title",function(){var a="",c=[];b(".wpglobus-quick-edit-title").each(function(e,f){var g=b(f),h=g.data("language");""!==g.val()&&(a=a+WPGlobusAdmin.data.locale_tag_start.replace("%s",h)+g.val()+WPGlobusAdmin.data.locale_tag_end),WPGlobusAdmin.qedit_titles[d][h].name=g.val(),c[e]=h});var e=b(document).triggerHandler("wpglobus_get_translations",{string:a,lang:c,id:d});"undefined"!=typeof e&&(a=e),b("input.ptitle").eq(0).val(a),WPGlobusAdmin.qedit_titles[d].source=a}),"undefined"!=typeof WPGlobusAdmin.data.tags&&b.each(WPGlobusAdmin.data.tags,function(a,b){WPGlobusAdmin.data.value[b].post_id={}}),b("a.save, input#bulk_edit").on("mouseenter",function(a){"undefined"!=typeof WPGlobusAdmin.data.tags&&("bulk_edit"==a.currentTarget.id?b("input#bulk_edit").unbind("click"):b("a.save").unbind("click"),b("a.save, input#bulk_edit").click(function(a){"bulk_edit"!=a.currentTarget.id&&b.ajaxSetup({async:!1});var c,d,e,f=b(this).parents("tr"),g=f.attr("id").replace("edit-","");b.each(WPGlobusAdmin.data.tags,function(a,b){if(c=f.find("textarea[name='"+WPGlobusAdmin.data.names[b]+"']"),0==c.size())return!0;WPGlobusAdmin.data.value[b].post_id[g]=c.val(),d=WPGlobusAdmin.data.value[b].post_id[g].split(","),e=[];for(var a=0;a<d.length;a++)d[a]=d[a].trim(" "),""!=d[a]&&(e[a]="undefined"==typeof WPGlobusAdmin.data.tag[b][d[a]]?d[a]:WPGlobusAdmin.data.tag[b][d[a]]);c.val(e.join(", "))}),"bulk_edit"!=a.currentTarget.id&&(inlineEditPost.save(g),b.ajaxSetup({async:!0}))}))}),b("#the-list").on("click","a.editinline",function(){var e=b(this);if(c=e.parents("tr").attr("id"),"post"===a)d=c.replace("post-","");else{if("taxonomy"!==a)return;d=c.replace("tag-","")}"post"===a&&"undefined"!=typeof WPGlobusAdmin.data.tags&&b.each(WPGlobusAdmin.data.tags,function(a,c){""!=WPGlobusAdmin.data.value[c]&&"undefined"!=typeof WPGlobusAdmin.data.value[c].post_id[d]&&b("#edit-"+d+' textarea[name="'+WPGlobusAdmin.data.names[c]+'"]').val(WPGlobusAdmin.data.value[c].post_id[d])});var f=b("#edit-"+d+" input.ptitle").eq(0),g=f.parents("label");f.val(WPGlobusAdmin.qedit_titles[d].source),f.addClass("hidden"),b(WPGlobusAdmin.data.template).insertAfter(g),"undefined"==typeof WPGlobusAdmin.qedit_titles[d]&&(WPGlobusAdmin.qedit_titles[d]={},WPGlobusAdmin.qedit_titles[d].source=b("#"+c+" .name a.row-title").text(),b(WPGlobusAdmin.data.enabled_languages).each(function(a,b){WPGlobusAdmin.qedit_titles[d][b]={},WPGlobusAdmin.qedit_titles[d][b].name=b==WPGlobusAdmin.data.default_language?WPGlobusAdmin.qedit_titles[d].source:"",WPGlobusAdmin.qedit_titles[d][b].description=""})),b(".wpglobus-quick-edit-title").each(function(a,c){var e=b(c).data("language");b(c).attr("id",e+d),"undefined"!=typeof WPGlobusAdmin.qedit_titles[d][e]&&b(c).attr("value",WPGlobusAdmin.qedit_titles[d][e].name.replace(/\\\'/g,"'"))})})}},taxonomy_edit:function(){var a=b(".form-table").eq(0);b.each(WPGlobusAdmin.tabs,function(c,d){var e=b(a[0].outerHTML),f="default"===d?WPGlobusAdmin.data.default_language:d;e.attr("id","table-"+d);var g=b(e);g.find("#name").attr("value",WPGlobusAdmin.data.i18n[d].name).attr("id","name-"+d).attr("name","name-"+d).addClass("wpglobus-taxonomy").attr("data-save-to","name").attr("data-language",f),g.find("#slug").attr("id","slug-"+d).attr("name","slug-"+d).addClass("wpglobus-taxonomy").attr("data-save-to","slug").attr("data-language",f),g.find("#parent").attr("id","parent-"+d).attr("name","parent-"+d).addClass("wpglobus-taxonomy").attr("data-save-to","parent").attr("data-language",f),g.find("#description").text(WPGlobusAdmin.data.i18n[d].description).attr("id","description-"+d).attr("name","description-"+d).addClass("wpglobus-taxonomy").attr("data-save-to","description").attr("data-language",f),"default"!==d&&(g.find("#slug-"+d).addClass("wpglobus-nosave").parents("tr").css("display","none"),g.find("#parent-"+d).addClass("wpglobus-nosave").parents("tr").css("display","none")),b("#tab-"+d).append(g[0].outerHTML)}),b(".wpglobus-taxonomy-tabs-ul").insertAfter("#ajax-response"),a.css("display","none"),b(".wrap").tabs(),b(".wpglobus-taxonomy").on("blur",function(){var a=b(this),c=a.data("save-to"),d="";"parent"===c||"slug"===c?d=a.val():b(".wpglobus-taxonomy").each(function(a,e){var f=b(e);f.hasClass("wpglobus-nosave")||c===f.data("save-to")&&""!==f.val()&&(d=d+WPGlobusAdmin.data.locale_tag_start.replace("%s",f.data("language"))+f.val()+WPGlobusAdmin.data.locale_tag_end)}),b("#"+c).val(d)})},nav_menus:function(){var a,c,d="#menu-to-edit .menu-item",e=function(){c!==b(d).size()&&(clearInterval(a),b(d).each(function(a,c){var d=b(c);if(!d.hasClass("wpglobus-menu-item")){var e=b(c).attr("id");b.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(a,c){var d=b("#"+e+" "+c),f=b(d);if(!f.hasClass("wpglobus-hidden")){f.addClass("wpglobus-hidden"),f.css("display","none");var g=f.parent("label"),h=f.parents("p");b(h).css("height","80px"),b(g).append('<div style="color:#f00;">'+WPGlobusAdmin.i18n.save_nav_menu+"</div>")}}),d.addClass("wpglobus-menu-item")}}))};b.ajaxSetup({beforeSend:function(f,g){"undefined"!=typeof g.data&&g.data.indexOf("action=add-menu-item")>=0&&(c=b(d).size(),a=setInterval(e,500))}}),b(d).each(function(a,c){var d=b(c).attr("id"),e=d.replace("menu-item-","");b.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(a,c){var f=b("#"+d+" "+c),g=b("#"+d+" "+c).parents("p"),h=0;b.each(WPGlobusAdmin.data.open_languages,function(d,i){var j=b(f[0].outerHTML);j.attr("id",b(f).attr("id")+"-"+i),j.attr("name",b(f).attr("id")+"-"+i),j.attr("data-language",i),j.attr("data-item-id",e),j.attr("placeholder",WPGlobusAdmin.data.en_language_name[i]);var k=WPGlobusAdmin.data.items[e][i][c]["class"];0===a&&i===WPGlobusAdmin.data.default_language?j.attr("class",k+" edit-menu-item-title"):j.attr("class",k),j.attr("value",WPGlobusAdmin.data.items[e][i][c].caption),j.css("margin-bottom","0.6em"),b(g).append(j[0].outerHTML),h=d}),h=40*(h+1),b(f).css("display","none").attr("class","").addClass("widefat wpglobus-hidden"),b(g).css("height",h+"px").addClass("wpglobus-menu-item-box")}),b(c).addClass("wpglobus-menu-item")}),b(".menus-move-left, .menus-move-right").each(function(a,c){var d,e=b(c),f=(e.parents("li").attr("id").replace("menu-item-",""),e.attr("title"));"undefined"!=typeof f&&b.each(WPGlobusAdmin.data.post_titles,function(a,b){f.indexOf(a)>=0&&(d=f.replace(a,b),e.attr("title",d),e.text(d))})}),b(".edit-menu-item-title").trigger("change"),wpNavMenu.menusChanged=!1,b(".wpglobus-menu-item").on("change",function(){var a,c,d,e=b(this),f="",g="";if(e.hasClass("wpglobus-item-title")){a=e.parents("li"),c=a.attr("id");var h=[];b.each(b("#"+c+" .wpglobus-item-title"),function(a,c){d=b(c);var e=d.data("language");""!==d.val()&&(f=f+WPGlobusAdmin.data.locale_tag_start.replace("%s",e)+d.val()+WPGlobusAdmin.data.locale_tag_end),h[a]=e,g=d.data("item-id")});var i=b(document).triggerHandler("wpglobus_get_menu_translations",{string:f,lang:h,id:g,type:"input.edit-menu-item-title"});"undefined"!=typeof i&&(f=i),b("input#edit-menu-item-title-"+g).val(f)}if(e.hasClass("wpglobus-item-attr")){a=e.parents("li"),c=a.attr("id");var h=[];b.each(b("#"+c+" .wpglobus-item-attr"),function(a,c){d=b(c);var e=d.data("language");""!==d.val()&&(f=f+WPGlobusAdmin.data.locale_tag_start.replace("%s",e)+d.val()+WPGlobusAdmin.data.locale_tag_end),h[a]=e,g=d.data("item-id")});var i=b(document).triggerHandler("wpglobus_get_menu_translations",{string:f,lang:h,id:g,type:"input.edit-menu-item-attr-title"});"undefined"!=typeof i&&(f=i),b("input#edit-menu-item-attr-title-"+g).val(f)}})},post_edit:function(){b.ajaxPrefilter(function(a){a.data.indexOf("wp_autosave")>=0&&b.each(WPGlobusAdmin.data.open_languages,function(c,d){var e=b("#title_"+d).val()||"";e=b.trim(e),""!=e&&(a.data=a.data+"&data%5Bwp_autosave%5D%5Bpost_title_"+d+"%5D="+e),e=b("#content_"+d).val()||"",e=b.trim(e),""!=e&&(a.data=a.data+"&data%5Bwp_autosave%5D%5Bcontent_"+d+"%5D="+e)})}),b("#post-body-content").prepend(b(".wpglobus-post-tabs-ul")),b.each(WPGlobusAdmin.tabs,function(a,c){"default"===c?(b("#postdivrich").wrap('<div id="tab-default"></div>'),b(b("#titlediv")).insertBefore("#postdivrich")):(b("#postdivrich-"+c).wrap('<div id="tab-'+c+'"></div>'),b(b("#titlediv-"+c)).insertBefore("#postdivrich-"+c))}),b("#post-body-content").tabs(),b("#title").val(WPGlobusAdmin.title),b("#content").text(WPGlobusAdmin.content),b("#excerpt").addClass("hidden"),"undefined"!=typeof WPGlobusVendor&&wpglobus_wpseo(),WPGlobusAdmin.data.modify_excerpt&&(b(WPGlobusAdmin.data.template).insertAfter("#excerpt"),b("body").on("blur",".wpglobus-excerpt",function(){var a="";b(".wpglobus-excerpt").each(function(c,d){var e=b(d);""!==e.val()&&(a=a+WPGlobusAdmin.data.locale_tag_start.replace("%s",e.data("language"))+e.val()+WPGlobusAdmin.data.locale_tag_end)}),b("#excerpt").eq(0).val(a)})),b("#publish").click(function(){"undefined"==typeof WPGlobusAdmin.data.tagsdiv||WPGlobusAdmin.data.tagsdiv.length<1||b(WPGlobusAdmin.data.tagsdiv).each(function(a,c){if(0==b("#"+c).size())return!0;var d=c.replace("tagsdiv-","");if("undefined"===d)return!0;if(0==b("#tax-input-"+d).size())return!0;var e,f=[];b("#tagsdiv-"+d+" .tagchecklist span").each(function(a,c){e=b(c).text(),e=e.replace("X","").trim(" "),f[a]="undefined"==typeof WPGlobusAdmin.data.tag[d][e]?e:WPGlobusAdmin.data.tag[d][e]}),b("#tax-input-"+d).val(f.join(", "))})}),b(".ui-state-default").on("click",function(){"link-tab-default"===b(this).attr("id")&&(b(window).scrollTop(b(window).scrollTop()+1),b(window).scrollTop(b(window).scrollTop()-1))})},start:function(){var a=this;b("#wpglobus_flags").select2({formatResult:this.format,formatSelection:this.format,minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),b("body").on("click","#enabled_languages-list li:first input",function(c){return c.preventDefault(),b(".redux-save-warn").css({display:"none"}),b("#enabled_languages-list").find("li:first > input").val("1"),0===b("#disable_first_language").length&&b(a.config.disable_first_language).insertAfter("#info_bar"),!1})},format:function(a){return'<img class="wpglobus_flag" src="'+WPGlobusAdmin.flag_url+a.text+'"/>&nbsp;&nbsp;'+a.text}},new a.App,a}(window.WPGlobusAdminApp||{},jQuery)});