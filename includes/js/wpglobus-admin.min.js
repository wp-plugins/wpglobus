var WPGlobusCore;!function(a){var b;b=WPGlobusCore={strpos:function(a,b,c){a=""+a;var d=a.indexOf(b,c);return d>=0?d:!1},TextFilter:function(a,c,d){if("undefined"==typeof a||""===a)return a;var e,f,g=[],h=!1;c=""==c?"en":c,d="undefined"==typeof d||""==d?"RETURN_IN_DEFAULT_LANGUAGE":d,g[0]=[],g[0].start=WPGlobusCoreData.locale_tag_start.replace("%s",c),g[0].end=WPGlobusCoreData.locale_tag_end,g[1]=[],g[1].start="<!--:"+c+"-->",g[1].end="<!--:-->",g[2]=[],g[2].start="[:"+c+"]",g[2].end="[:";for(var i=0;3>i;i++)if(e=b.strpos(a,g[i].start),e!==!1){e+=g[i].start.length,f=b.strpos(a,g[i].end,e),a=f===!1?a.substr(e):a.substr(e,f-e),h=!0;break}return h||("RETURN_EMPTY"==d?(c!=WPGlobusCoreData.default_language||/(\{:|\[:|<!--:)[a-z]{2}/.test(a))&&(a=""):c==WPGlobusCoreData.default_language?/(\{:|\[:|<!--:)[a-z]{2}/.test(a)&&(a=""):a=b.TextFilter(a,WPGlobusCoreData.default_language)),a},addLocaleMarks:function(a,b){return WPGlobusCoreData.locale_tag_start.replace("%s",b)+a+WPGlobusCoreData.locale_tag_end},getTranslations:function(c){var d,e={};return a.each(WPGlobusCoreData.enabled_languages,function(a,f){d=f==WPGlobusCoreData.default_language?"RETURN_IN_DEFAULT_LANGUAGE":"RETURN_EMPTY",e[f]=b.TextFilter(c,f,d)}),e},getString:function(c,d,e){if("undefined"==typeof c)return c;"undefined"==typeof d&&(d=""),"undefined"==typeof e&&(e=WPGlobusCoreData.language),c=b.getTranslations(c),c[e]=d;var f="";return a.each(c,function(a,c){""!=c&&a!=WPGlobusCoreData.default_language&&(f+=b.addLocaleMarks(c,a))}),""!=c[WPGlobusCoreData.default_language]&&(f=""==f?c[WPGlobusCoreData.default_language]:b.addLocaleMarks(c[WPGlobusCoreData.default_language],WPGlobusCoreData.default_language)+f),f}}}(jQuery);var WPGlobusDialogApp;!function(a){var b;b=WPGlobusDialogApp={option:{listenClass:".wpglobus_dialog_start",settingsClass:".wpglobus_dialog_settings",dialogTabs:"#wpglobus-dialog-tabs",dialogTitle:"",customData:null,callback:function(){}},form:void 0,element:void 0,element_by:"id",id:"",clone_id:"",wpglobus_id:"",type:"textarea",source:"",order:{},value:{},request:"core",attrs:{},dialogTitle:"",startButton:['<span id="wpglobus-dialog-start-{{clone_id}}" ','style="{{style}}" ','data-type="control" data-dialog-title="{{title}}" ','data-source-type="" data-source-id="{{id}}" data-source-name="{{name}}" ','data-nodename="{{nodename}}"',"{{sbTitle}} ",'class="{{classes}}"></span>'].join(""),startButtonClass:"wpglobus_dialog_start wpglobus_dialog_icon",clicks:0,init:function(c){b.option=a.extend(b.option,c),a(b.option.dialogTabs).tabs(),b.dialogTitle=b.option.dialogTitle,this.attachListener(),null!=b.option.customData&&"undefined"!=typeof b.option.customData.addElements&&a.each(b.option.customData.addElements,function(a,c){b.addElement(c)})},convertToId:function(a){return a=a.replace(/\]/g,""),a=a.replace(/\[/g,"-")},addElement:function(c){var d={id:null,dialogTitle:"",style:"",styleTextareaWrapper:"",sbTitle:""};if("string"==typeof c)d.id=c;else{if("object"!=typeof c)return;d=a.extend(d,c)}var e,f,g,h=null,i=null,j=null,k=null,l=b.startButton,m="";b.element_by="id",k=document.getElementById(d.id),null===k?(b.element_by="name",k=document.getElementsByName(d.id)):(m=k.nodeName,m=m.toLowerCase()),0!=k.length&&(i=d.id,"id"==b.element_by?h=a("#"+i):(m=k[0].nodeName,m=m.toLowerCase(),h=a(m+'[name="'+i+'"]')),j="undefined"===h.attr("name")?i:h.attr("name"),b.clone_id=b.convertToId(i),a("#wpglobus-"+b.clone_id).length>0||a(m+'[name="wpglobus-'+j+'"]').length>0||(e=a(h.clone()),g=h.attr("style")||"",h.attr("style","display:none;"),e.attr("id","wpglobus-"+b.clone_id).attr("name","wpglobus-"+j),"id"==b.element_by?e.attr("data-source-id",i).attr("data-source-name","").attr("data-source-get-by",b.element_by):e.attr("data-source-id","").attr("data-source-name",j).attr("data-source-get-by",b.element_by),"textarea"==m?(f=WPGlobusCore.getTranslations(h.text())[WPGlobusCoreData.language],e.text(f),e.attr("data-nodename","textarea"),""==d.style?e.attr("style",g+";width:95%;float:left;"):e.attr("style",g+";"+d.style)):(f=WPGlobusCore.getTranslations(h.val())[WPGlobusCoreData.language],e.attr("value",f),e.attr("data-nodename","input"),""!=d.style&&e.attr("style",g+";"+d.style)),l=l.replace(/{{clone_id}}/g,b.clone_id),"id"==b.element_by?(l=l.replace(/{{id}}/g,b.clone_id),l=l.replace(/{{name}}/g,""),l=l.replace(/{{nodename}}/g,"")):(l=l.replace(/{{id}}/g,""),l=l.replace(/{{name}}/g,j),l=l.replace(/{{nodename}}/g,m)),l="textarea"==m?l.replace("{{style}}","float:left;margin-top:0;"):l.replace("{{style}}",""),b.startButtonClass="textarea"==m?b.startButtonClass+" wpglobus-textarea wpglobus-textarea-"+b.clone_id:b.startButtonClass,l=l.replace("{{classes}}",b.startButtonClass),l=""==d.dialogTitle?l.replace("{{title}}",b.dialogTitle):l.replace("{{title}}",d.dialogTitle),l=""==d.sbTitle?l.replace("{{sbTitle}}",d.sbTitle):l.replace("{{sbTitle}}",'title="'+d.sbTitle+'"'),a(l).insertAfter(h),a(e).insertAfter(h),"textarea"==m&&(a("#wpglobus-"+b.clone_id).addClass("wpglobus-textarea-"+b.clone_id),a(".wpglobus-textarea-"+b.clone_id).wrapAll('<div class="wpglobus-textarea-wrapper" style="'+d.styleTextareaWrapper+'"></div>')),a(document).on("change","#wpglobus-"+b.clone_id,function(){var b=a(this),c=b.data("source-id");c=""==c?b.data("nodename")+'[name="'+b.data("source-name")+'"]':"#"+c,a(c).val(WPGlobusCore.getString(a(c).val(),b.val()))})))},saveDialog:function(){var c,d,e,f="",g="",h="";a(".wpglobus_dialog_textarea").each(function(b,i){c=a(i),d=c.val(),e=c.data("language"),e==WPGlobusAdmin.data.language&&(h=d),""!=d&&(f+=WPGlobusCore.addLocaleMarks(d,e),e==WPGlobusCoreData.default_language&&(g=d))}),f=f.length==g.length+8?g:f,a(b.id).val(f),f=""==h?g:h,a(b.wpglobus_id).val(f)},dialog:a("#wpglobus-dialog-wrapper").dialog({autoOpen:!1,width:650,modal:!0,dialogClass:"wpglobus-dialog",buttons:[{text:"Save","class":"wpglobus-button-save",click:function(){b.saveDialog(),b.dialog.dialog("close")}},{text:"Cancel","class":"wpglobus-button-cancel",click:function(){b.dialog.dialog("close")}}],open:function(){var c=b.dialogTitle;"undefined"!=typeof b.attrs.maxlength&&(a(".wpglobus_dialog_textarea").attr("maxlength",b.attrs.maxlength),c+=" | maxlength="+b.attrs.maxlength),a(".wpglobus-dialog .ui-dialog-title").text(c)},close:function(){b.form[0].reset()}}),attachListener:function(){a(document).on("click",b.option.settingsClass,function(){a(".wpglobus_dialog_options_wrapper").hasClass("hidden")?a(".wpglobus_dialog_options_wrapper").removeClass("hidden"):a(".wpglobus_dialog_options_wrapper").addClass("hidden")}),a(document).on("click",".wpglobus_dialog_option",function(c){var d,e=a(this),f=e.data("object");b.order.action="save_post_meta_settings",b.order.post_type=WPGlobusAdmin.data.post_type,b.order.checked=e.prop("checked"),b.order.id=e.attr("id"),b.order.meta_key=e.data("meta-key"),d=b.ajax(b.order),d.done(function(b){"ok"==b.result&&("true"==b.checked?a(f).removeClass("wpglobus_dialog_start_hidden"):a(f).addClass("wpglobus_dialog_start_hidden"))}).fail(function(a){}).always(function(a,b){})}),a(document).on("click",b.option.listenClass,function(c){b.element=a(this),b.id=b.element.data("source-id"),""==b.id?(b.id=b.element.data("nodename")+'[name="'+b.element.data("source-name")+'"]',b.wpglobus_id="#wpglobus-"+b.convertToId(b.element.data("source-name"))):(b.wpglobus_id="#wpglobus-"+b.id,b.id="#"+b.id),b.clicks++,1==b.clicks&&setTimeout(function(){if(1==b.clicks)b.onClick(c);else{var d=a(b.id);d.hasClass("hidden")?d.removeClass("hidden").attr("style","display:block;"):d.addClass("hidden").attr("style","display:none;")}b.clicks=0},200)}),b.form=b.dialog.find("form#wpglobus-dialog-form").on("submit",function(a){a.preventDefault(),b.saveDialog()})},ajax:function(b){return a.ajax({type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusAdmin.process_ajax,order:b},dataType:"json",async:!1})},onClick:function(c){"undefined"==typeof b.element.data("dialog-title")||""==b.element.data("dialog-title")?b.dialogTitle=b.option.dialogTitle:b.dialogTitle=b.element.data("dialog-title"),"undefined"!=typeof b.id&&(b.attrs.maxlength=a(b.id).attr("maxlength")),b.source=b.element.data("source-value"),"undefined"==typeof b.source&&(b.source=a(b.id).val(),"ajax"==b.request||(b.value=WPGlobusCore.getTranslations(b.source))),a.each(b.value,function(b,c){a("#wpglobus-dialog-"+b).val(c)}),b.dialog.dialog("open")}}}(jQuery),jQuery(document).ready(function(){"use strict";window.WPGlobusAdminApp=function(a,b){return a.App=function(a){void 0===window.WPGlobusAdminApp&&(this.config={debug:!1,version:WPGlobusAdmin.version},this.status="ok","undefined"===WPGlobusAdmin?(this.status="error",this.config.debug&&console.log("Error options loading")):this.config.debug&&console.dir(WPGlobusAdmin),this.config.disable_first_language=['<div id="disable_first_language" style="display:block;" class="redux-field-errors notice-red">',"<strong>","<span>&nbsp;</span>",WPGlobusAdmin.i18n.cannot_disable_language,"</strong>","</div>"].join(""),b.extend(this.config,a),"ok"===this.status&&this.init())},a.App.prototype={$document:b(document),init:function(){this.admin_init(),b("#content").addClass("wpglobus-editor").attr("data-language",WPGlobusAdmin.data.default_language),b("textarea[id^=content_]").each(function(a,c){var d=b(c).attr("id").replace("content_","");b(c).attr("data-language",d)}),"post-edit"===WPGlobusAdmin.page?(this.post_edit(),this.set_dialog(),"undefined"!=typeof WPGlobusAioseop&&WPGlobusAioseop.init()):"menu-edit"===WPGlobusAdmin.page?this.nav_menus():"taxonomy-edit"===WPGlobusAdmin.page?WPGlobusAdmin.data.tag_id&&this.taxonomy_edit():"taxonomy-quick-edit"===WPGlobusAdmin.page?this.quick_edit("taxonomy"):"edit.php"===WPGlobusAdmin.page?this.quick_edit("post"):"options-general.php"==WPGlobusAdmin.page?this.options_general():"widgets.php"==WPGlobusAdmin.page?(WPGlobusWidgets.init(),WPGlobusDialogApp.init({dialogTitle:"Edit text"})):"wpglobus_options"==WPGlobusAdmin.page?this.start():WPGlobusDialogApp.init({customData:WPGlobusCoreData.page_custom_data})},admin_init:function(){var a=b(".wpglobus-addons-group a").data("key");if("indefined"!=typeof a)if(window.location.search.indexOf("page=wpglobus_options&tab="+a)>=0)window.location="admin.php?page=wpglobus-addons";else{var c=b("#toplevel_page_wpglobus_options li").eq(a+1);b(c).find("a").attr("href","admin.php?page=wpglobus-addons").attr("onclick","window.location=jQuery(this).attr('href');return false;")}},options_general:function(){var a=b("#blogname"),c=b("body");a.addClass("hidden"),b("#wpglobus-blogname").insertAfter(a).removeClass("hidden"),c.on("blur",".wpglobus-blogname",function(){var c="";b(".wpglobus-blogname").each(function(a,d){var e=b(d),f=e.data("language");""!==e.val()&&(c=c+WPGlobusAdmin.data.locale_tag_start.replace("%s",f)+e.val()+WPGlobusAdmin.data.locale_tag_end)}),a.val(c)});var d=b("#blogdescription");d.addClass("hidden"),b("#wpglobus-blogdescription").insertAfter(d).removeClass("hidden"),c.on("blur",".wpglobus-blogdesc",function(){var a="";b(".wpglobus-blogdesc").each(function(c,d){var e=b(d),f=e.data("language");""!==e.val()&&(a=a+WPGlobusAdmin.data.locale_tag_start.replace("%s",f)+e.val()+WPGlobusAdmin.data.locale_tag_end)}),d.val(a)})},quick_edit:function(a){if("undefined"!=typeof WPGlobusAdmin.data.has_items&&WPGlobusAdmin.data.has_items){var c="",d=0;b(document).ajaxComplete(function(a,e,f){"undefined"!=typeof f.data&&""!=c&&f.data.indexOf("action=inline-save-tax&")>=0&&(b("#"+c+" a.row-title").text(WPGlobusAdmin.qedit_titles[d][WPGlobusAdmin.data.language].name),b("#"+c+" .description").text(WPGlobusAdmin.qedit_titles[d][WPGlobusAdmin.data.language].description))});var e={};b("#the-list tr").each(function(c,f){var g=b(f),h="post"===a?"post-":"tag-";d=g.attr("id").replace(h,""),e[d]={},"post"===a?e[d].source=g.find(".post_title").text():"taxonomy"===a&&(e[d].source=b("#inline_"+d+" .name").text())});var f={};f.action="get_titles",f.type=a,f.taxonomy="undefined"==typeof WPGlobusAdmin.data.taxonomy?!1:WPGlobusAdmin.data.taxonomy,f.title=e,b.ajax({type:"POST",url:WPGlobusAdmin.ajaxurl,data:{action:WPGlobusAdmin.process_ajax,order:f},dataType:"json"}).done(function(a){WPGlobusAdmin.qedit_titles=a.qedit_titles,b.each(a.bulkedit_post_titles,function(a,c){b("#inline_"+a+" .post_title").text(c[WPGlobusAdmin.data.language].name)})}).fail(function(a){}).always(function(a,b){}),b("body").on("change",".wpglobus-quick-edit-title",function(){var a="",c=[];b(".wpglobus-quick-edit-title").each(function(e,f){var g=b(f),h=g.data("language");""!==g.val()&&(a=a+WPGlobusAdmin.data.locale_tag_start.replace("%s",h)+g.val()+WPGlobusAdmin.data.locale_tag_end),WPGlobusAdmin.qedit_titles[d][h].name=g.val(),c[e]=h});var e=b(document).triggerHandler("wpglobus_get_translations",{string:a,lang:c,id:d});"undefined"!=typeof e&&(a=e),b("input.ptitle").eq(0).val(a),WPGlobusAdmin.qedit_titles[d].source=a}),"undefined"!=typeof WPGlobusAdmin.data.tags&&b.each(WPGlobusAdmin.data.tags,function(a,b){WPGlobusAdmin.data.value[b].post_id={}}),b("a.save, input#bulk_edit").on("mouseenter",function(a){"undefined"!=typeof WPGlobusAdmin.data.tags&&("bulk_edit"==a.currentTarget.id?b("input#bulk_edit").unbind("click"):b("a.save").unbind("click"),b("a.save, input#bulk_edit").click(function(a){"bulk_edit"!=a.currentTarget.id&&b.ajaxSetup({async:!1});var c,d,e,f=b(this).parents("tr"),g=f.attr("id").replace("edit-","");b.each(WPGlobusAdmin.data.tags,function(a,b){if(c=f.find("textarea[name='"+WPGlobusAdmin.data.names[b]+"']"),0==c.size())return!0;WPGlobusAdmin.data.value[b].post_id[g]=c.val(),d=WPGlobusAdmin.data.value[b].post_id[g].split(","),e=[];for(var h=0;h<d.length;h++)d[h]=d[h].trim(" "),""!=d[h]&&("undefined"==typeof WPGlobusAdmin.data.tag[b][d[h]]?e[h]=d[h]:e[h]=WPGlobusAdmin.data.tag[b][d[h]]);c.val(e.join(", "))}),"bulk_edit"!=a.currentTarget.id&&(inlineEditPost.save(g),b.ajaxSetup({async:!0}))}))}),b("#the-list").on("click","a.editinline",function(){var e=b(this);if(c=e.parents("tr").attr("id"),"post"===a)d=c.replace("post-","");else{if("taxonomy"!==a)return;d=c.replace("tag-","")}"post"===a&&"undefined"!=typeof WPGlobusAdmin.data.tags&&b.each(WPGlobusAdmin.data.tags,function(a,c){""!=WPGlobusAdmin.data.value[c]&&"undefined"!=typeof WPGlobusAdmin.data.value[c].post_id[d]&&b("#edit-"+d+' textarea[name="'+WPGlobusAdmin.data.names[c]+'"]').val(WPGlobusAdmin.data.value[c].post_id[d])});var f=b("#edit-"+d+" input.ptitle").eq(0),g=f.parents("label");f.val(WPGlobusAdmin.qedit_titles[d].source),f.addClass("hidden"),b(WPGlobusAdmin.data.template).insertAfter(g),"undefined"==typeof WPGlobusAdmin.qedit_titles[d]&&(WPGlobusAdmin.qedit_titles[d]={},WPGlobusAdmin.qedit_titles[d].source=b("#"+c+" .name a.row-title").text(),b(WPGlobusAdmin.data.enabled_languages).each(function(a,b){WPGlobusAdmin.qedit_titles[d][b]={},b==WPGlobusAdmin.data.default_language?WPGlobusAdmin.qedit_titles[d][b].name=WPGlobusAdmin.qedit_titles[d].source:WPGlobusAdmin.qedit_titles[d][b].name="",WPGlobusAdmin.qedit_titles[d][b].description=""})),b(".wpglobus-quick-edit-title").each(function(a,c){var e=b(c).data("language");b(c).attr("id",e+d),"undefined"!=typeof WPGlobusAdmin.qedit_titles[d][e]&&b(c).attr("value",WPGlobusAdmin.qedit_titles[d][e].name.replace(/\\\'/g,"'"))})})}},taxonomy_edit:function(){var a=[];a[0]="name",a[1]="description";var c=function(a,c){var d,e=b("#"+a),f=e.clone(),g=e.attr("name"),h="wpglobus-element wpglobus-element_"+a+" wpglobus-element_"+c;d=document.getElementById(a),d=d.nodeName,b(f).attr("id",a+"_"+c),b(f).attr("name",g+"_"+c),c!==WPGlobusCoreData.default_language&&(h+=" hidden"),b(f).attr("class",h),b(f).attr("data-save-to",a),b(f).attr("data-language",c),"INPUT"==d?b(f).attr("value",b("#wpglobus-link-tab-"+c).data(a)):"TEXTAREA"==d&&b(f).text(b("#wpglobus-link-tab-"+c).data(a)),e.addClass("hidden"),0==b(".wpglobus-element_"+a).size()?b(f).insertAfter(e):b(f).insertAfter(b(".wpglobus-element_"+a).last())};b.each(WPGlobusCoreData.enabled_languages,function(d,e){b.each(a,function(a,b){c(b,e)})}),b(".wpglobus-taxonomy-tabs").insertAfter("#ajax-response"),b(".wrap").tabs(),b("body").on("click",".wpglobus-taxonomy-tabs li",function(a){var c=b(this),d=c.data("language");b(".wpglobus-element").addClass("hidden"),b(".wpglobus-element_"+d).removeClass("hidden")}),b(".wpglobus-element").on("change",function(){var a=b(this),c=a.data("save-to"),d="";b(".wpglobus-element").each(function(a,e){var f=b(e),g=f.val();f.data("save-to")==c&&""!==g&&(d+=WPGlobusCore.addLocaleMarks(g,f.data("language")))}),b("#"+c).val(d)})},nav_menus:function(){var a,c,d="#menu-to-edit .menu-item",e=function(){c!==b(d).size()&&(clearInterval(a),b(d).each(function(a,c){var d=b(c);if(!d.hasClass("wpglobus-menu-item")){var e=b(c).attr("id");b.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(a,c){var d=b("#"+e+" "+c),f=b(d);if(!f.hasClass("wpglobus-hidden")){f.addClass("wpglobus-hidden"),f.css("display","none");var g=f.parent("label"),h=f.parents("p");b(h).css("height","80px"),b(g).append('<div style="color:#f00;">'+WPGlobusAdmin.i18n.save_nav_menu+"</div>")}}),d.addClass("wpglobus-menu-item")}}))};b.ajaxSetup({beforeSend:function(f,g){"undefined"!=typeof g.data&&g.data.indexOf("action=add-menu-item")>=0&&(c=b(d).size(),a=setInterval(e,500))}}),b(d).each(function(a,c){var d=b(c).attr("id"),e=d.replace("menu-item-","");b.each(["input.edit-menu-item-title","input.edit-menu-item-attr-title"],function(a,c){var f=b("#"+d+" "+c),g=b("#"+d+" "+c).parents("p"),h=0;b.each(WPGlobusAdmin.data.open_languages,function(d,i){var j=b(f[0].outerHTML);j.attr("id",b(f).attr("id")+"-"+i),j.attr("name",b(f).attr("id")+"-"+i),j.attr("data-language",i),j.attr("data-item-id",e),j.attr("placeholder",WPGlobusAdmin.data.en_language_name[i]);var k=WPGlobusAdmin.data.items[e][i][c]["class"];0===a&&i===WPGlobusAdmin.data.default_language?j.attr("class",k+" edit-menu-item-title"):j.attr("class",k),j.attr("value",WPGlobusAdmin.data.items[e][i][c].caption),j.css("margin-bottom","0.6em"),b(g).append(j[0].outerHTML),h=d}),h=40*(h+1),b(f).css("display","none").attr("class","").addClass("widefat wpglobus-hidden"),b(g).css("height",h+"px").addClass("wpglobus-menu-item-box")}),b(c).addClass("wpglobus-menu-item")}),b(".menus-move-left, .menus-move-right").each(function(a,c){var d,e=b(c),f=(e.parents("li").attr("id").replace("menu-item-",""),e.attr("title"));"undefined"!=typeof f&&b.each(WPGlobusAdmin.data.post_titles,function(a,b){f.indexOf(a)>=0&&(d=f.replace(a,b),e.attr("title",d),e.text(d))})}),b(".edit-menu-item-title").trigger("change"),wpNavMenu.refreshAdvancedAccessibility(),wpNavMenu.menusChanged=!1,b(".wpglobus-menu-item").on("change",function(){var a,c,d=b(this),e=d.data("item-id");d.hasClass("wpglobus-item-title")&&(a=WPGlobusCore.getString(b("input#edit-menu-item-title-"+e).val(),d.val(),d.data("language")),c=b(document).triggerHandler("wpglobus_get_menu_translations",{string:a,lang:WPGlobusCoreData.open_languages,id:e,type:"input.edit-menu-item-title"}),"undefined"!=typeof c&&(a=c),b("input#edit-menu-item-title-"+e).val(a)),d.hasClass("wpglobus-item-attr")&&(a=WPGlobusCore.getString(b("input#edit-menu-item-attr-title-"+e).val(),d.val(),d.data("language")),c=b(document).triggerHandler("wpglobus_get_menu_translations",{string:a,lang:WPGlobusCoreData.open_languages,id:e,type:"input.edit-menu-item-attr-title"}),"undefined"!=typeof c&&(a=c),b("input#edit-menu-item-attr-title-"+e).val(a))})},post_edit:function(){b(document).on("heartbeat-send",function(a,c){"undefined"!=typeof c.wp_autosave&&(c.wpglobus_heartbeat="wpglobus",b.each(WPGlobusAdmin.data.open_languages,function(a,d){var e=b("#title_"+d).val()||"";e=b.trim(e),""!=e&&(c.wp_autosave["post_title_"+d]=e),e=b("#content_"+d).val()||"",e=b.trim(e),""!=e&&(c.wp_autosave["content_"+d]=e)}))});var a="#postdivrich",c=!0,d="#post-body-content";if(WPGlobusAdmin.data.support.editor===!1&&(a="#titlediv",c=!1),WPGlobusAdmin.data.support.title===!1&&(c=!1),b(d).prepend(b(".wpglobus-post-body-tabs-list")),b.each(WPGlobusAdmin.tabs,function(d,e){"default"===e?(b(a).wrap('<div id="tab-default"></div>'),c&&b(b("#titlediv")).insertBefore(a)):(b(a+"-"+e).wrap('<div id="tab-'+e+'"></div>'),c&&b(b("#titlediv-"+e)).insertBefore(a+"-"+e))}),b(d).addClass("wpglobus-post-body-tabs").tabs({beforeActivate:function(a,c){var d=c.oldTab[0].id.replace("link-tab-",""),e=c.newTab[0].id.replace("link-tab-","");"default"==d&&(d=WPGlobusCoreData.default_language),"default"==e&&(e=WPGlobusCoreData.default_language);var f=b(document).triggerHandler("wpglobus_post_body_tabs",[d,e]);return f||"undefined"==typeof f?!0:!1}}),b("#title").val(WPGlobusAdmin.title),b("#content").text(WPGlobusAdmin.content),b("#excerpt").addClass("hidden").css({display:"none"}),"undefined"!=typeof WPGlobusVendor&&wpglobus_wpseo(),WPGlobusAdmin.data.modify_excerpt&&(b(WPGlobusAdmin.data.template).insertAfter("#excerpt"),b("body").on("change",".wpglobus-excerpt",function(){var a=b(this);b("#excerpt").val(WPGlobusCore.getString(b("#excerpt").val(),a.val(),a.data("language")))})),"undefined"!=typeof wp.utils&&"undefined"!=typeof wp.utils.WordCounter&&b.each(WPGlobusCoreData.enabled_languages,function(a,b){!function(a,b,c){a(function(){function d(){var a,c;a=!g||g.isHidden()?e.val():g.getContent({format:"raw"}),c=b.count(a),c!==h&&f.text(c),h=c}if(c==WPGlobusCoreData.default_language)var e=a("#content"),f=a("#wp-word-count").find(".word-count");else var e=a("#content_"+c),f=a("#wp-word-count-"+c).find(".word-count-"+c);var g,h=0;a(document).on("tinymce-editor-init",function(a,b){"content"===b.id&&(g=b,b.on("nodechange keyup",_.debounce(d,1e3)))}),e.on("input keyup",_.debounce(d,1e3)),d()})}(jQuery,new wp.utils.WordCounter,b)}),"undefined"!=typeof wpWordCount){var e=0,f=WPGlobusCoreData.open_languages,g=this.$document,h={};f.shift(),b.each(WPGlobusCoreData.open_languages,function(a,b){h[b]=0});var i={settings:{strip:/<[a-zA-Z\/][^<>]*>/g,clean:/[0-9.(),;:!?%#$¿'"_+=\\/-]+/g,w:/\S\s+/g,c:/\S/g},block:h,wc:function(a,c,d){var e,f=this,g=0;e=b(c==WPGlobusCoreData.default_language?".word-count":".word-count-"+c),void 0===d&&(d=wordCountL10n.type),"w"!==d&&"c"!==d&&(d="w"),f.block[c]||(f.block[c]=1,setTimeout(function(){a&&(a=a.replace(f.settings.strip," ").replace(/&nbsp;|&#160;/gi," "),a=a.replace(f.settings.clean,""),a.replace(f.settings[d],function(){g++})),e.html(g.toString()),setTimeout(function(){f.block[c]=0},2e3)},1))}};g.bind("wpglobuscountwords",function(a,b,c){i.wc(b,c)}),b.each(f,function(a,c){var d=b("#content_"+c);g.triggerHandler("wpglobuscountwords",[d.val(),c]),d.keyup(function(a){var b=a.keyCode||a.charCode;return b==e?!0:((13==b||8==e||46==e)&&g.triggerHandler("wpglobuscountwords",[d.val(),c]),e=b,!0)})}),b(document).triggerHandler("wpglobuscountwords",[b("#content").val(),WPGlobusCoreData.default_language])}b("body").on("click","#publish, #save-post",function(){if(WPGlobusAdmin.data.open_languages.length>1){b(document).triggerHandler("wpglobus_before_save_post",{content_tabs_id:d});var a,c=b("#title").val(),e="",f="";0==c.length&&(a=WPGlobusAdmin.data.open_languages.indexOf(WPGlobusAdmin.data.default_language),WPGlobusAdmin.data.open_languages.splice(a,1),b(WPGlobusAdmin.data.open_languages).each(function(a,d){f=0==a?"":"-",c=b("#title_"+d).val(),c.length>0&&(0==e.length&&(f=""),e=e+f+c)})),e.length>0&&b("#title").val(e)}"undefined"==typeof WPGlobusAdmin.data.tagsdiv||WPGlobusAdmin.data.tagsdiv.length<1||b(WPGlobusAdmin.data.tagsdiv).each(function(a,c){if(0==b("#"+c).size())return!0;var d=c.replace("tagsdiv-","");if("undefined"===d)return!0;if(0==b("#tax-input-"+d).size())return!0;var e,f=[];b("#tagsdiv-"+d+" .tagchecklist span").each(function(a,c){e=b(c).text(),e=e.replace("X","").trim(" "),"undefined"==typeof WPGlobusAdmin.data.tag[d][e]?f[a]=e:f[a]=WPGlobusAdmin.data.tag[d][e]}),b("#tax-input-"+d).val(f.join(", "))})}),b(".ui-state-default").on("click",function(){"link-tab-default"===b(this).attr("id")&&(b(window).scrollTop(b(window).scrollTop()+1),b(window).scrollTop(b(window).scrollTop()-1))})},start:function(){var a=this;b("#wpglobus_flags").select2({formatResult:this.format,formatSelection:this.format,minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),b("body").on("click","#enabled_languages-list li:first input",function(c){return c.preventDefault(),b(".redux-save-warn").css({display:"none"}),b("#enabled_languages-list").find("li:first > input").val("1"),0===b("#disable_first_language").length&&b(a.config.disable_first_language).insertAfter("#info_bar"),!1})},format:function(a){return'<img class="wpglobus_flag" src="'+WPGlobusAdmin.flag_url+a.text+'"/>&nbsp;&nbsp;'+a.text},set_dialog:function(){var a,c=!1,d=function(a){var d,e,f,g,h="wpglobus_dialog_start wpglobus_dialog_icon";g=['<div class="wpglobus_dialog_options_wrapper hidden">','<input style="width:initial;" id="wpglobus-cb-{{id}}" data-object="#wpglobus-dialog-start-{{id}}" data-meta-key="{{meta-key}}" class="wpglobus_dialog_option wpglobus_dialog_cb" type="checkbox" {{checked}} />',"</div>"].join(""),e="undefined"==typeof a?"#the-list tr":"#the-list tr#"+a,b(e).each(function(){var a,c,e,i=b(this),j=i.attr("id"),k=i.find("textarea"),l=h;return d=k.attr("id"),void 0===d?!0:(e=b("#"+j+"-key").val(),a=b("#"+d).clone(),b(k).addClass("wpglobus-dialog-field-source hidden"),c=k.attr("name"),b(a).attr("id","wpglobus-"+d),b(a).attr("name","wpglobus-"+c),b(a).attr("data-source-id",d),b(a).attr("class","wpglobus-dialog-field"),b(a).val(WPGlobusCore.TextFilter(b(k).val(),WPGlobusCoreData.language)),b(a).insertAfter(k),f=g.replace(/{{id}}/g,d),f=f.replace(/{{meta-key}}/g,e),void 0===WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type]?f=f.replace(/{{checked}}/,"checked"):void 0!==WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type][e]&&"false"==WPGlobusAdmin.data.post_meta_settings[WPGlobusAdmin.data.post_type][e]?(f=f.replace(/{{checked}}/,""),l=h+" wpglobus_dialog_start_hidden"):(f=f.replace(/{{checked}}/,"checked"),l=h),void i.append('<td style="width:20px;"><div id="wpglobus-dialog-start-'+d+'" data-type="control" data-source-type="textarea" data-source-id="'+d+'" class="'+l+'"></div>'+f+"</td>"))}),!c&&b("#list-table .wpglobus_dialog_start").size()>0&&(b("#list-table thead tr").append('<th class="wpglobus-control-head"><div class="wpglobus_dialog_settings wpglobus_dialog_icon"></div></th>'),c=!0)};d(),b("body").on("change",".wpglobus-dialog-field",function(){var a,c=b(this),d="#"+c.data("source-id"),e="",f="";"undefined"!=typeof d&&(e=b(d).val(),/(\{:|\[:|<!--:)[a-z]{2}/.test(e)?(b.each(WPGlobusCoreData.enabled_languages,function(b,d){a=d==WPGlobusCoreData.language?c.val():WPGlobusCore.TextFilter(e,d,"RETURN_EMPTY"),""!=a&&(f+=WPGlobusCore.addLocaleMarks(a,d))}),b(d).val(f)):b(d).val(c.val()))}),b(document).ajaxSend(function(b,c,d){"add-meta"==d.action&&(a=d.element)}),b(document).ajaxComplete(function(c,e,f){"add-meta"==f.action&&void 0!==e.responseXML&&d("newmeta"==a?"meta-"+b(e.responseXML.documentElement.outerHTML).find("meta").attr("id"):a)}),WPGlobusDialogApp.init({dialogTitle:"Edit meta"})}},new a.App,a}(window.WPGlobusAdminApp||{},jQuery)});