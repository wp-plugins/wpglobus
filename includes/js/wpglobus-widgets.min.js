var WPGlobusWidgets;!function(a){"use strict";var b;b=WPGlobusWidgets={init:function(){b.add_elements(),b.attachListeners()},wysiwygClean:function(){a(".wpglobus-dialog-field").each(function(b,c){var d=a(c).data("source-id");if(1==a("#"+d+"-tmce").size()){var e=a(c).next(".wpglobus_dialog_start");a(c).remove(),a(e).remove()}})},add_elements:function(c,d){var e,f=[];f[0]='input[type="text"]',f[1]="textarea","undefined"==typeof c||"class"==c?(e=".widget-liquid-right .widget .widget-content",a.each(f,function(a,c){b.make_clone(e,c)})):"id"==c&&(e="#"+d+" .widget-content",a.each(f,function(a,c){b.make_clone(e,c)}))},make_clone:function(b,c){a(b+" "+c).each(function(b,d){var e,f,g,h,i=a(d);if(h=i.attr("id"),"undefined"==typeof h||-1!=h.indexOf("-number"))return!0;if(e=a("#"+h).clone(),a(i).addClass("wpglobus-dialog-field-source hidden"),f=i.attr("name"),a(e).attr("id","wpglobus-"+h),a(e).attr("name","wpglobus-"+f),a(e).attr("data-source-id",h),a(e).attr("class","wpglobus-dialog-field"),a(e).attr("style","width:90%;"),g=WPGlobusCore.TextFilter(a(i).val(),WPGlobusCoreData.language),a(e).val(g),a('<div style="width:20px;" data-type="control" data-source-type="" data-source-id="'+h+'" class="wpglobus-widgets wpglobus_dialog_start wpglobus_dialog_icon"></div>').insertAfter(i),a(e).insertAfter(i),'input[type="text"]'==c&&""!=g){var j=i.parents(".widget").attr("id");a("#"+j+" .in-widget-title").text(": "+g)}})},attachListeners:function(){a(document).ajaxComplete(function(c,d,e){if(-1!=e.data.indexOf("action=save-widget"))if(-1!=e.data.indexOf("delete_widget=1"));else{var f=e.data.split("widget-id=");f=f[1].split("&"),a(".widget-liquid-right .widget").each(function(c,d){var e=a(d).attr("id");-1!==e.indexOf(f[0])&&(b.add_elements("id",e),b.wysiwygClean())})}}),a("body").on("change",".wpglobus-dialog-field",function(){var b,c=a(this),d="#"+c.data("source-id"),e="",f="";"undefined"!=typeof d&&(e=a(d).val(),/(\{:|\[:|<!--:)[a-z]{2}/.test(e)?(a.each(WPGlobusCoreData.enabled_languages,function(a,d){b=d==WPGlobusCoreData.language?c.val():WPGlobusCore.TextFilter(e,d,"RETURN_EMPTY"),""!=b&&(f+=WPGlobusCore.addLocaleMarks(b,d))}),a(d).val(f)):a(d).val(c.val()))}),a(document).on("click",".widget-title, .widget-title-action",function(a){a.preventDefault(),b.wysiwygClean()})}}}(jQuery);