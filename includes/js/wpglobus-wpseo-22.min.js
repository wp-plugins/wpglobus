"use strict";var wpglobus_wpseo=function(){function a(a,b,c){if("undefined"!=typeof a){if("undefined"==typeof replacedVars&&0==jQuery("#title").size())return a;var d="#title",e="#excerpt-"+b,f="#content";b!=WPGlobusAdmin.data.default_language&&(d="#title_"+b,f="#content_"+b),jQuery(d).length&&(a=a.replace(/%%title%%/g,jQuery(d).val().replace(/(<([^>]+)>)/gi,""))),a=a.replace(/%%sitedesc%%/g,WPGlobusAdmin.data.blogdescription[b]),a=a.replace(/%%sitename%%/g,WPGlobusAdmin.data.blogname[b]),a=a.replace(/%%sep%%/g,wpseoMetaboxL10n.sep),a=a.replace(/%%date%%/g,wpseoMetaboxL10n.date),a=a.replace(/%%id%%/g,wpseoMetaboxL10n.id),a=a.replace(/%%page%%/g,wpseoMetaboxL10n.page),a=a.replace(/%%currenttime%%/g,wpseoMetaboxL10n.currenttime),a=a.replace(/%%currentdate%%/g,wpseoMetaboxL10n.currentdate),a=a.replace(/%%currentday%%/g,wpseoMetaboxL10n.currentday),a=a.replace(/%%currentmonth%%/g,wpseoMetaboxL10n.currentmonth),a=a.replace(/%%currentyear%%/g,wpseoMetaboxL10n.currentyear),a=a.replace(/%%focuskw%%/g,jQuery("#yoast_wpseo_focuskw_"+b).val().replace(/(<([^>]+)>)/gi,""));var g="";jQuery(e).length&&(g=ystClean(jQuery(e).val().replace(/(<([^>]+)>)/gi,"")),a=a.replace(/%%excerpt_only%%/g,g)),""===g&&jQuery(f).length&&(g=jQuery(f).val().replace(/(<([^>]+)>)/gi,"").substring(0,wpseoMetaboxL10n.wpseo_meta_desc_length-1)),a=a.replace(/%%excerpt%%/g,g),jQuery("#parent_id").length&&jQuery("#parent_id option:selected").text()!==wpseoMetaboxL10n.no_parent_text&&(a=a.replace(/%%parent_title%%/g,jQuery("#parent_id option:selected").text()));var h=ystEscapeFocusKw(wpseoMetaboxL10n.sep),i=new RegExp(h+" "+h,"g");if(a=a.replace(i,wpseoMetaboxL10n.sep),-1!==a.indexOf("%%")&&null!==a.match(/%%[a-z0-9_-]+%%/i))for(var j=/%%[a-z0-9_-]+%%/gi,k=a.match(j),l=0;l<k.length;l++)if("undefined"==typeof replacedVars[k[l]])a=a.replace(k[l],replacedVars[k[l]]);else{var m=k[l];replacedVars[m]="",ystAjaxReplaceVariables(m,c)}c(a)}}function b(a,b,c){var d,e=ystEscapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+c).val()));if(""===e)return a;d=-1!==e.search(" ")?e.split(" "):new Array(e);for(var f=0;f<d.length;f++){var g=ystClean(d[f]),h="";b?(g=g.replace(" ","-").toLowerCase(),h=new RegExp("([-/])("+g+")([-/])?")):h=new RegExp("(^|[ \\s\n\r	\\.,'\\(\"\\+;!?:\\-]+)("+g+")($|[ \\s\n\r	\\.,'\\)\"\\+;!?:\\-]+)","gim"),void 0!==a&&(a=a.replace(h,"$1<strong>$2</strong>$3"))}return a}function c(a){var c=jQuery.trim(ystClean(jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+a).val())),e=jQuery("<div />"),f=jQuery("#wpseosnippet_"+a);if(""===c&&""!==wpseoMetaboxL10n.wpseo_metadesc_template&&(c=wpseoMetaboxL10n.wpseo_metadesc_template),""!==c)c=ystReplaceVariables(c,function(c){c=e.text(c).html(),c=ystClean(c);var g=wpseoMetaboxL10n.wpseo_meta_desc_length-c.length;g=0>g?'<span class="wrong">'+g+"</span>":'<span class="good">'+g+"</span>",jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(g),c=ystSanitizeDesc(c),c=b(c,!1),f.find(".desc span.autogen").html(""),f.find(".desc span.content").html(c),d(a)});else{jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(wpseoMetaboxL10n.wpseo_meta_desc_length),f.find(".desc span.content").html(""),d(a);var g="#content";a!=WPGlobusAdmin.data.default_language&&(g="#content_"+a),"undefined"!=typeof tinyMCE&&null!==tinyMCE.get("excerpt-"+a)&&(c=tinyMCE.get("excerpt-"+a).getContent(),c=ystClean(c)),"undefined"!=typeof tinyMCE&&null!==tinyMCE.get(g)&&0===c.length&&(c=tinyMCE.get(g).getContent(),c=ystClean(c));var h=ystEscapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val()));if(""!==h){var i=new RegExp(h,"gim");c=-1!==c.search(i)&&c.length>wpseoMetaboxL10n.wpseo_meta_desc_length?c.substr(c.search(i),wpseoMetaboxL10n.wpseo_meta_desc_length):c.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length)}else c=c.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length);c=b(c,!1),c=ystSanitizeDesc(c),f.find(".desc span.autogen").html(c)}}function d(a){var b=jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val());b=ystEscapeFocusKw(b).toLowerCase();var c="#title",d="#content";a!=WPGlobusAdmin.data.default_language&&(c="#title_"+a,d="#content_"+a);var e,f,g=jQuery(document).triggerHandler("wpglobus_post_name_full",{postnamefull:"#editable-post-name-full",language:a})||"#editable-post-name-full";jQuery(g).length&&(e=jQuery(g).text(),f=wpseoMetaboxL10n.wpseo_permalink_template.replace("%postname%",e).replace("http://",""));var h=new RegExp("(^|[ \\s\n\r	\\.,'\\(\"\\+;!?:\\-])"+ystRemoveLowerCaseDiacritics(b)+"($|[\\s\n\r	.,'\\)\"\\+!?:;\\-])","gim"),i=ystRemoveLowerCaseDiacritics(b),j=new RegExp(i.replace(/\s+/g,"[-_\\//]"),"gim"),k=jQuery("#focuskwresults_"+a),l=jQuery("#wpseosnippet_"+a).find(".desc span.content").text();if(""!==b){var m="<p>"+wpseoMetaboxL10n.keyword_header+"</p>";m+="<ul>",jQuery(c).length&&(m+="<li>"+wpseoMetaboxL10n.article_header_text+ystFocusKwTest(jQuery(c).val(),h)+"</li>"),m+="<li>"+wpseoMetaboxL10n.page_title_text+ystFocusKwTest(jQuery("#wpseosnippet_title_"+a).text(),h)+"</li>",m+="<li>"+wpseoMetaboxL10n.page_url_text+ystFocusKwTest(f,j)+"</li>",jQuery(d).length&&(m+="<li>"+wpseoMetaboxL10n.content_text+ystFocusKwTest(jQuery(d).val(),h)+"</li>"),m+="<li>"+wpseoMetaboxL10n.meta_description_text+ystFocusKwTest(l,h)+"</li>",m+="</ul>",k.html(m)}else k.html("")}if("undefined"!=typeof wpseoMetaboxL10n){var e=function(b,c){var e="",f=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+c),g=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title-length-warning_"+c),h=jQuery("<div />"),i=jQuery("#wpseosnippet_title_"+c);return f.val()?e=f.val().replace(/(<([^>]+)>)/gi,""):(e=wpseoMetaboxL10n.wpseo_title_template,e=h.html(e).text()),""===e?(i.html(""),void g.hide()):(e=ystClean(e),e=jQuery.trim(e),e=h.text(e).html(),b&&f.val(e),void(e=a(e,c,function(a){a=ystSanitizeTitle(a),jQuery("#wpseosnippet_title_"+c).html(a);var b=h.html(a).text();f.attr("placeholder",b);var e=document.getElementById("wpseosnippet_title_"+c);null!==e&&(e.scrollWidth>e.clientWidth?g.show():g.hide()),d(c)})))},f=function(a){e(!1,a),c(a)},g=function(){jQuery(".yoast_help").qtip({content:{attr:"alt"},position:{my:"bottom left",at:"top center"},style:{tip:{corner:!0},classes:"yoast-qtip qtip-rounded qtip-blue"},show:"click",hide:{fixed:!0,delay:500}})};jQuery("#wpglobus-wpseo-tabs").tabs();var h=jQuery("#wpglobus-wpseo-attr"),i=jQuery(".wpseotab.general .form-table"),j=h.data("ids"),k=h.data("names"),l="";j=j+","+h.data("qtip"),j=j.split(","),k=k.split(","),jQuery("#wpglobus-wpseo-tabs").insertBefore(i),jQuery(".wpglobus-wpseo-general").each(function(a,b){var d=jQuery(b),g=d.data("language");if(d.html('<table class="form-table wpglobus-table-'+g+'" data-language="'+g+'">'+i.html()+"</table>"),jQuery.each(k,function(a,b){jQuery("#"+b).attr("name",b+"_"+g)}),jQuery.each(j,function(a,b){var c=jQuery("#"+b);"wpseosnippet"==b&&c.addClass("wpglobus-wpseosnippet"),"focuskwresults"==b&&c.addClass("wpglobus-focuskwresults"),wpseoMetaboxL10n.field_prefix+"metadesc"==b&&c.addClass("wpglobus-wpseo_metadesc").text(d.data("metadesc")),wpseoMetaboxL10n.field_prefix+"title"==b&&c.addClass("wpglobus-wpseo_title").val(d.data("wpseotitle")),wpseoMetaboxL10n.field_prefix+"focuskw"==b&&c.addClass("wpglobus-wpseo_focuskw").val(d.data("focuskw")),c.attr("id",b+"_"+g),jQuery("#"+b+"_"+g).attr("data-language",g)}),l="complete"==d.data("permalink")?d.data("url-"+g):d.data("url-"+g)+jQuery("#editable-post-name-full").text()+"/",jQuery("#wpseosnippet_"+g+" .url").text(l),f(g),"undefined"!=typeof jQuery().autocomplete){var h,m={};jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+g).autocomplete({minLength:3,formatResult:function(a){return jQuery("<div/>").html(a).html()},source:function(a,b){var c=a.term;return c in m?void b(m[c]):(a._ajax_nonce=wpseoMetaboxL10n.wpseo_keyword_suggest_nonce,a.action="wpseo_get_suggest",void(h=jQuery.getJSON(ajaxurl,a,function(a,d,e){m[c]=a,e===h&&b(a)})))}})}jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+g).keyup(function(){e(!1,jQuery(this).data("language"))}),jQuery("#title_"+g).keyup(function(){var a=jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language;e(!1,a),c(a)}),0==a&&jQuery("#title").keyup(function(){e(!1,WPGlobusAdmin.data.default_language),c(WPGlobusAdmin.data.default_language)}),0==a&&jQuery("body").on("change","#parent_id",function(){jQuery.each(WPGlobusAdmin.data.enabled_languages,function(a,b){e(!1,b),c(b)})}),jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+g).keyup(function(){c(jQuery(this).data("language"))}),jQuery("body").on("keyup","#excerpt-"+g,function(){c(jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language)}),0==a&&jQuery(".wpglobus-editor").focusout(function(){c(jQuery(this).data("language"))});var n=!1;jQuery(document).on("change","#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+g,function(){var a=jQuery(this).data("language"),b=jQuery("#focuskwhelp_"+a);-1!=jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val().search(",")?(b.click(),n=!0):n&&(b.qtip("hide"),n=!1),f(a)})}),i.addClass("hidden"),jQuery("body").on("change",".wpglobus-wpseo_metadesc",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"metadesc",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_title",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"title",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_focuskw",function(a){var b="#"+wpseoMetaboxL10n.field_prefix+"focuskw",c=jQuery(this);jQuery(b).val(WPGlobusCore.getString(jQuery(b).val(),c.val(),c.data("language")))}),jQuery("body").on("click",".wpglobus-post-body-tabs-list li",function(a){var b=jQuery(this);b.hasClass("wpglobus-post-tab")&&jQuery("#wpglobus-wpseo-tabs").tabs("option","active",jQuery(this).data("order"))}),g(),ystUpdateSnippet()}};